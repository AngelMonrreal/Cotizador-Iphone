<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">

<title>MONMEX</title>
<meta name="apple-mobile-web-app-title" content="MONMEX">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">

<link rel="apple-touch-icon" href="logoinicio.jpeg">
<link rel="icon" href="logoinicio.jpeg">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#fff;
  padding:16px;
  display:flex;
  justify-content:center;
}

.app{width:100%;max-width:420px}

select,input,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid #cbd5e1;
  font-size:14px;
}

button{background:#0f172a;color:#fff;cursor:pointer}
button.admin{background:#334155}
button.eliminar{background:#dc2626}

.tabs{display:flex;gap:8px;margin-top:12px}

.panel{
  border:1px solid #e2e8f0;
  border-radius:14px;
  padding:14px;
  margin-top:12px;
}

.hidden{display:none}

.label{text-align:center;font-size:13px;color:#475569}
.precio{text-align:center;font-size:30px;font-weight:700;margin-top:4px}

.row{display:flex;justify-content:space-between;font-size:14px;margin-top:8px}

.ganancia{
  color:#16a34a;
  font-weight:600;
  border-top:1px solid #e2e8f0;
  padding-top:8px;
  margin-top:10px;
}

.small{text-align:center;font-size:11px;color:#64748b;margin-top:2px}
</style>
</head>

<body>
<div class="app">

<div style="text-align:center;margin-bottom:6px">
  <img src="logomonmex.png.jpeg" style="width:170px;border-radius:18px">
  <div class="small">Compra y venta de electrónica</div>
</div>

<select id="producto" onchange="cargarModelos()">
  <option value="">Producto</option>
</select>

<select id="modelo" onchange="cargarCapacidades()">
  <option value="">Modelo</option>
</select>

<select id="capacidad" onchange="calcular()">
  <option value="">Capacidad</option>
</select>

<div class="tabs">
  <button onclick="mostrarCliente()">Cliente</button>
  <button class="btn" onclick="toggleAdmin()">Administrar modelos</button>
</div>

<!-- CLIENTE -->
<div class="panel" id="clientePanel">
  <div class="label">Compra Evaluada</div>
  <div class="precio" id="precioCompraCliente">—</div>
</div>

<!-- LOGIN -->
<div class="panel hidden" id="loginPanel">
  <input type="password" id="pinInput" placeholder="PIN">
  <button onclick="validarPin()">Entrar</button>
</div>

<!-- ADMIN -->
<div class="panel hidden" id="adminPanel">
  <div class="row"><span>Compra</span><span id="precioCompraAdmin">—</span></div>
  <div class="row"><span>Venta</span><span id="precioVentaAdmin">—</span></div>
  <div class="row ganancia"><span>Ganancia</span><span id="ganancia">—</span></div>

  <hr>

  <input id="newProducto" placeholder="Producto (iPhone, PlayStation)">
  <input id="newModelo" placeholder="Modelo (PS5, 14 Pro Max)">
  <input id="newCapacidad" placeholder="Capacidad (GB / TB)">
  <input id="newCompra" placeholder="Precio compra">
  <input id="newVenta" placeholder="Precio venta">

  <button onclick="guardar()">Guardar / Actualizar</button>
  <button class="eliminar" onclick="eliminar()">Eliminar seleccionado</button>
</div>

</div>

<script>
const PIN="2303";
let adminActivo=false;

let data=JSON.parse(localStorage.getItem("monmex"))||[];

function guardar(){
  let p=newProducto.value.trim();
  let m=newModelo.value.trim();
  let c=newCapacidad.value.trim();
  let buy=+newCompra.value;
  let sell=+newVenta.value;
  if(!p||!m||!c||!buy||!sell)return alert("Completa todo");

  data=data.filter(x=>!(x.p==p&&x.m==m&&x.c==c));
  data.push({p,m,c,buy,sell});
  localStorage.setItem("monmex",JSON.stringify(data));
  cargarTodo();
  newProducto.value=newModelo.value=newCapacidad.value=newCompra.value=newVenta.value="";
}

function eliminar(){
  data=data.filter(x=>!(x.p==producto.value&&x.m==modelo.value&&x.c==capacidad.value));
  localStorage.setItem("monmex",JSON.stringify(data));
  cargarTodo();
}

function cargarTodo(){
  producto.innerHTML='<option value="">Producto</option>';
  [...new Set(data.map(x=>x.p))].forEach(p=>{
    let o=document.createElement("option");o.textContent=o.value=p;producto.appendChild(o);
  });
  modelo.innerHTML='<option value="">Modelo</option>';
  capacidad.innerHTML='<option value="">Capacidad</option>';
  calcular();
}

function cargarModelos(){
  modelo.innerHTML='<option value="">Modelo</option>';
  capacidad.innerHTML='<option value="">Capacidad</option>';
  data.filter(x=>x.p==producto.value).forEach(x=>{
    if(![...modelo.options].some(o=>o.value==x.m)){
      let o=document.createElement("option");o.value=o.textContent=x.m;modelo.appendChild(o);
    }
  });
}

function cargarCapacidades(){
  capacidad.innerHTML='<option value="">Capacidad</option>';
  data.filter(x=>x.p==producto.value&&x.m==modelo.value)
    .forEach(x=>{
      let o=document.createElement("option");
      o.value=o.textContent=x.c;
      capacidad.appendChild(o);
    });
}

function calcular(){
  let x=data.find(x=>x.p==producto.value&&x.m==modelo.value&&x.c==capacidad.value);
  if(x){
    precioCompraCliente.textContent="$"+x.buy;
    precioCompraAdmin.textContent="$"+x.buy;
    precioVentaAdmin.textContent="$"+x.sell;
    ganancia.textContent="$"+(x.sell-x.buy);
  }else{
    precioCompraCliente.textContent="—";
    precioCompraAdmin.textContent="—";
    precioVentaAdmin.textContent="—";
    ganancia.textContent="—";
  }
}

function mostrarCliente(){
  clientePanel.classList.remove("hidden");
  adminPanel.classList.add("hidden");
  loginPanel.classList.add("hidden");
  adminActivo=false;
}

function toggleAdmin(){
  if(adminActivo){mostrarCliente();}
  else{clientePanel.classList.add("hidden");loginPanel.classList.remove("hidden");}
}

function validarPin(){
  if(pinInput.value===PIN){
    loginPanel.classList.add("hidden");
    adminPanel.classList.remove("hidden");
    adminActivo=true;
    pinInput.value="";
  }else alert("PIN incorrecto");
}

cargarTodo();
</script>
</body>
</html>
